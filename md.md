1. В составе заказа товары с акциями 1 и 3:

Для товаров с типом акции 3 или без акции рассчитать стоимость доставки (не применяя акцию)
Для товаров с типом акции 1 рассчитать стоимость = значению поля Акционная стоимость
Просуммировать полученные стоимости на шаге 1 и 3
Отнять от суммарной стоимости доставки значение поля Акционная стоимость для типа акции = 3
